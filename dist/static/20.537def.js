webpackJsonp([20],{525:function(e,r,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var t=a(5),l=s(t),o=a(6),i=s(o),n=a(3),d=s(n),m=a(4),u=s(m),c=a(8),f=s(c),p=a(7),v=s(p),h=a(2),b=s(h),g=(0,l.default)("label",{},void 0,"可添加用户"),N=(0,l.default)("i",{className:"fa fa-long-arrow-right col-md-12 dir-right"}),U=(0,l.default)("i",{className:"fa fa-long-arrow-left col-md-12 dir-left"}),y=(0,l.default)("label",{},void 0,"角色内用户"),M=function(e){function r(e){(0,d.default)(this,r);var a=(0,f.default)(this,(r.__proto__||(0,i.default)(r)).call(this,e));return a.addUserHander=a.addUserHander.bind(a),a.removeUserHander=a.removeUserHander.bind(a),a.saveUserHander=a.saveUserHander.bind(a),a.returnHander=a.returnHander.bind(a),a}return(0,v.default)(r,e),(0,u.default)(r,[{key:"componentWillMount",value:function(){this.props.roleManageUserList(this.props.params.id),this.props.allUserList(this.props.roleManage.roleUserList.member)}},{key:"componentDidMount",value:function(){this.refs.save.disabled=!0}},{key:"addUserHander",value:function(e){this.refs.save.disabled=!1;for(var r=this.props.roleManage.roleUserList,a=this.props.roleManage.allUserList,s=0;s<a.member.length;s++)"admin"==a.member[s].userName&&a.splice(s,1);for(var t=document.querySelector("#select1"),l=[],o=0;o<t.length;o++)t.options[o].selected&&l.push(t[o].index);for(var i=[],n=0;n<a.member.length;n++){for(var d=!0,m=0;m<r.member.length;m++)r.member[m].userName!=a.member[n].userName&&"admin"!=a.member[n].userName||(d=!1);d&&i.push(a.member[n])}for(var u=0;u<l.length;u++)r.member.push(i[l[u]]);l.length>0&&this.props.addUserORRemoveToRole(r)}},{key:"removeUserHander",value:function(){this.refs.save.disabled=!1;for(var e=this.props.roleManage.roleUserList,r=this.props.roleManage.allUserList,a=0;a<r.member.length;a++)"admin"==r.member[a].userName&&r.splice(a,1);for(var s=document.querySelector("#select2"),t=[],l=0;l<s.length;l++)s.options[l].selected&&t.push(s[l].index);for(var o=[],i=0;i<r.member.length;i++){for(var n=!0,d=0;d<e.member.length;d++)e.member[d].userName!=r.member[i].userName&&"admin"!=r.member[i].userName||(n=!1);n&&o.push(r.member[i])}t.sort().reverse();for(var m=0;m<t.length;m++)e.member.splice(t[m],1);t.length>0&&this.props.addUserORRemoveToRole(e)}},{key:"saveUserHander",value:function(){this.refs.save.disabled=!0;for(var e=this.props.roleManage.selectRole.roleName,r=this.props.roleManage.roleUserList.member,a=[],s=0;s<r.length;s++)a.push(r[s].userName);this.props.saveUserRole(e,a),0==this.props.roleManage.isSave.code&&(this.refs.save.disabled=!1,this.props.history.replace("/roleManage"),window.location.reload())}},{key:"returnHander",value:function(){this.props.history.replace("/roleManage")}},{key:"render",value:function(){for(var e=this.props.roleManage.roleUserList.member,r=this.props.roleManage.allUserList.member,a=0;a<r.length;a++)"admin"==r[a].userName&&r.splice(a,1);for(var s=e.map(function(e,r){return(0,l.default)("option",{value:e.userName},void 0,e.userName+" ("+e.name+")")}),t=[],o=0;o<r.length;o++){for(var i=!0,n=0;n<e.length;n++)e[n].userName!=r[o].userName&&"admin"!=r[o].userName||(i=!1);i&&t.push(r[o])}var d=t.map(function(e,r){return(0,l.default)("option",{value:e.userName},void 0,e.userName+" ("+e.name+")")}),m=this.props.roleManage.selectRole.roleName;return(0,l.default)("div",{id:"roleEdit",className:"box box-primary"},void 0,(0,l.default)("div",{className:"row"},void 0,(0,l.default)("div",{className:"col-md-12"},void 0,(0,l.default)("h3",{className:"col-md-12"},void 0,m),(0,l.default)("div",{className:"box-body"},void 0,(0,l.default)("div",{className:"form-group col-md-4"},void 0,g,b.default.createElement("select",{multiple:"multiple",id:"select1",ref:"select1",className:"form-control",size:"8"},d),(0,l.default)("div",{className:"col-md-12 button"},void 0,(0,l.default)("button",{type:"submit",className:"btn btn-primary",onClick:this.returnHander},void 0,"返回"),b.default.createElement("button",{type:"submit",className:"btn btn-primary",ref:"save",onClick:this.saveUserHander},"保存"))),(0,l.default)("div",{className:"col-md-2 dir"},void 0,(0,l.default)("div",{className:"dir-button"},void 0,b.default.createElement("button",{ref:"add",onClick:this.addUserHander},N),b.default.createElement("button",{ref:"remove",onClick:this.removeUserHander},U))),(0,l.default)("div",{className:"form-group col-md-4"},void 0,y,b.default.createElement("select",{multiple:"multiple",id:"select2",ref:"select2",className:"form-control",size:"8"},s))))))}}]),r}(h.Component);r.default=M}});