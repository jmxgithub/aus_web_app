webpackJsonp([15],{21:function(a,e){"use strict";function t(a){var e={data:a.data||[],destroy:!0,dom:a.dom||'<"top"f>rt<"bottom"lip>',columns:a.columns||[],language:{sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 条结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",sInfoEmpty:"显示第 0 至 0 条结果，共 0 条",sInfoFiltered:"(由 _MAX_ 条结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},paging:a.paging,pageLength:a.pageLength||10,columnDefs:a.columnDefs||"",order:a.order||[],createdRow:a.createdRow||null};a.scrollX&&(e.scrollX=a.scrollX);var t=$("#"+a.id).DataTable(e);return t}function d(a,e,t,d){$("#"+a+" tbody").off(e,t).on(e,t,d)}function r(a){var e=$("#"+a).DataTable().row($(this).parents("tr")).data();return e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t,e.bindTableEvent=d,e.getTableItem=r},201:function(a,e){"use strict";function t(a){var e=$(a.parent).qtip({content:a.content||"",position:{my:"left center",at:"bottom right",target:$(a.parent)},style:{classes:"qtip-blue qtip-shadow"},show:{event:a.event||"mouseenter"}});return e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t},503:function(a,e,t){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(e,"__esModule",{value:!0});var r=t(5),n=d(r),s=t(6),i=d(s),o=t(3),l=d(o),u=t(4),c=d(u),b=t(8),f=d(b),h=t(7),v=d(h),p=t(2),k=d(p),m=t(183),T=d(m),g=t(201),L=d(g),D=t(197),H=t(21),y=d(H),O=t(217),_=d(O),w=t(267),A=d(w),N="",x=(0,n.default)("tr",{},void 0,(0,n.default)("th",{},void 0,"名称"),(0,n.default)("th",{},void 0,"描述"),(0,n.default)("th",{},void 0,"创建人"),(0,n.default)("th",{},void 0,"创建时间")),E=(0,n.default)("tr",{},void 0,(0,n.default)("th",{},void 0,"名称"),(0,n.default)("th",{},void 0,"描述"),(0,n.default)("th",{},void 0,"创建人"),(0,n.default)("th",{},void 0,"创建时间"),(0,n.default)("th",{},void 0,"操作")),R=(0,n.default)("button",{type:"submit",name:"createDashboard",className:"btn btn-primary"},void 0,"新建"),Q=function(a){function e(a){(0,l.default)(this,e);var t=(0,f.default)(this,(e.__proto__||(0,i.default)(e)).call(this,a));return t.createTable=t.createTable.bind(t),t.addHandler=t.addHandler.bind(t),t.detailHandler=t.detailHandler.bind(t),t.editHandler=t.editHandler.bind(t),t.analysisHandler=t.analysisHandler.bind(t),t.removeHandler=t.removeHandler.bind(t),t.removeOKHandler=t.removeOKHandler.bind(t),t.clickOwnerHandler=t.clickOwnerHandler.bind(t),t.saveToQuickLinkHandler=t.saveToQuickLinkHandler.bind(t),t.saveToQuickLinkOKHandler=t.saveToQuickLinkOKHandler.bind(t),t}return(0,v.default)(e,a),(0,c.default)(e,[{key:"componentWillMount",value:function(){this.props.readDashboard(),N=A.default.getQuickLinkInfo()}},{key:"componentDidUpdate",value:function(){this.createTable(this.props.dashboard.dashboardData.result.data),$('button[name = "createDashboard"]').on("click",this.addHandler)}},{key:"createTable",value:function(a){var e={};e.id="dashboardList",e.columns=[{data:"dashboardName",defaultContent:"-"},{data:"desc",defaultContent:"-"},{data:"owner",defaultContent:"-"},{data:"createTime",defaultContent:"-"}],e.order=[[3,"desc"]];var t=sessionStorage.getItem("userRolePermission");t.indexOf("DASHBOARD_")!=-1&&(e.columnDefs=[{targets:0,render:function(a,e,t){var d=t.dashboardName||"",r='<span style="cursor: pointer;" title="'+d+'" > '+(0,D.cutStr)(d,20)+"</span> ";return r}},{targets:1,render:function(a,e,t){var d=t.desc||"",r='<span style="cursor: pointer;" title="'+d+'" > '+(0,D.cutStr)(d,40)+"</span> ";return r}},{targets:2,render:function(a,e,t){var d='<a href="javascript:void(0);" class="owner">'+t.owner+"</a> ";return d}},{targets:4,render:function(a,e,d){var r="",n=sessionStorage.getItem("XDataUserName");return t.indexOf("DASHBOARD_ANALYSIS")!=-1&&(r+="<a href='javascript:void(0);'  class='dashboardAnalysis btn btn-default btn-xs'  ><i class='fa fa-search'></i> 分析</a> "),t.indexOf("DASHBOARD_QUERY")!=-1&&(r+="<a href='javascript:void(0);' class='dashboardDetail btn btn-default btn-xs'><i class='fa fa-file-text-o'></i> 详情</a> "),t.indexOf("DASHBOARD_MODIFY")!=-1&&d.owner===n&&(r+="<a href='javascript:void(0);' class='dashboardEdit btn btn-default btn-xs'><i class='fa fa-pencil-square-o'></i> 修改</a> "),t.indexOf("DASHBOARD_DELETE")!=-1&&d.owner===n&&(r+="<a href='javascript:void(0);' class='dashboardRemove btn btn-default btn-xs' data-toggle=\"modal\" data-target=\"#removeDashboard\"><i class='fa fa-trash-o'></i> 删除</a> "),N.quickLink.indexOf(d.dashboardName)===-1&&d.owner===n&&(r+="<a href='javascript:void(0);' class='addToQuickLink btn btn-default btn-xs' data-toggle=\"modal\" data-target=\"#saveToQuickLink\"><i class='fa fa-star-o'></i> 添加导航</a> "),r}}]),e.data=a,(0,y.default)(e),(0,H.bindTableEvent)("dashboardList","click","a.dashboardAnalysis",this.analysisHandler),(0,H.bindTableEvent)("dashboardList","click","a.dashboardDetail",this.detailHandler),(0,H.bindTableEvent)("dashboardList","click","a.dashboardEdit",this.editHandler),(0,H.bindTableEvent)("dashboardList","click","a.dashboardRemove",this.removeHandler),(0,H.bindTableEvent)("dashboardList","click","a.addToQuickLink",this.saveToQuickLinkHandler),(0,H.bindTableEvent)("dashboardList","click","a.owner",this.clickOwnerHandler)}},{key:"saveToQuickLinkHandler",value:function(a){var e=$("#dashboardList").DataTable().row($(a.currentTarget).parents("tr")).data();this.props.selectDashboard(e),this.refs.saveToQuickLink.setContent("您确定要添加仪表板："+e.dashboardName+"到快速导航吗？")}},{key:"saveToQuickLinkOKHandler",value:function(){var a=this.props.dashboard.selectedRecord.dashboardName;N.quickLink=N.quickLink+a+";",this.props.setQuickLinkInfo(N),$("#saveToQuickLink").modal("hide")}},{key:"clickOwnerHandler",value:function(a){var e=_.default.userDetail($(a.currentTarget).text());e=e.result.detail;var t=(0,L.default)({parent:a.currentTarget,event:"click",content:"<dl><dt>用户名：</dt><dd>"+e.userName+"</dd></dl>\n            <dl><dt>姓名：</dt><dd>"+e.name+"</dd></dl>\n            </dl><dl><dt>部门：</dt><dd>"+e.department+"</dd></dl>\n            </dl><dl><dt>职位：</dt><dd>"+e.position+"</dd></dl>\n            </dl><dl><dt>电话：</dt><dd>"+e.phoneNo+"</dd></dl>\n            <dl><dt>邮箱：</dt><dd>"+e.email+"</dd></dl>"}),d=t.qtip("api");d.show()}},{key:"analysisHandler",value:function(a){var e=$("#dashboardList").DataTable().row($(a.currentTarget).parents("tr")).data();this.props.history.replace("/dashboard/analysis/"+e.dashboardName)}},{key:"addHandler",value:function(){this.props.history.replace("/dashboard/add")}},{key:"detailHandler",value:function(a){var e=$("#dashboardList").DataTable().row($(a.currentTarget).parents("tr")).data();this.props.history.replace("/dashboard/detail/"+e.dashboardName)}},{key:"editHandler",value:function(a){var e=$("#dashboardList").DataTable().row($(a.currentTarget).parents("tr")).data();this.props.history.replace("/dashboard/update/"+e.dashboardName)}},{key:"removeHandler",value:function(a){var e=$("#dashboardList").DataTable().row($(a.currentTarget).parents("tr")).data();this.props.selectDashboard(e),this.refs.delDashboard.setContent("您确定要删除仪表板："+e.dashboardName+"吗？")}},{key:"removeOKHandler",value:function(){var a=[],e=this.props.dashboard.selectedRecord.dashboardName;a.push(e),this.props.delDashboard(a);var t=A.default.getQuickLinkInfo();t.quickLink.indexOf(e)!=-1&&(t.quickLink=t.quickLink.split(e+";")[0],this.props.setQuickLinkInfo(t)),$("#removeDashboard").modal("hide")}},{key:"render",value:function(){var a=x,e=sessionStorage.getItem("userRolePermission");e.indexOf("DASHBOARD_")!=-1&&(a=E);var t="";return sessionStorage.getItem("userRolePermission").indexOf("DASHBOARD_CREATE")!=-1&&(t=R),(0,n.default)("div",{id:"dashboardManage",className:"box box-primary"},void 0,(0,n.default)("div",{className:"row"},void 0,(0,n.default)("div",{className:"col-md-12"},void 0,(0,n.default)("div",{className:"box-header"},void 0,t),(0,n.default)("div",{className:"box-body"},void 0,(0,n.default)("table",{id:"dashboardList",className:"table table-striped table-bordered"},void 0,(0,n.default)("thead",{},void 0,a))))),k.default.createElement(T.default,{modalId:"removeDashboard",ref:"delDashboard",title:"删除仪表板",okHandler:this.removeOKHandler}),k.default.createElement(T.default,{modalId:"saveToQuickLink",ref:"saveToQuickLink",title:"添加快速导航",okHandler:this.saveToQuickLinkOKHandler}))}}]),e}(p.Component);e.default=Q}});