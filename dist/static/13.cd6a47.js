webpackJsonp([13],{12:function(e,t){"use strict";function a(e){$(e).iCheck({checkboxClass:"icheckbox_minimal-blue",radioClass:"iradio_minimal-blue",disabledClass:"disabled"})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},21:function(e,t){"use strict";function a(e){var t={data:e.data||[],destroy:!0,dom:e.dom||'<"top"f>rt<"bottom"lip>',columns:e.columns||[],language:{sProcessing:"处理中...",sLengthMenu:"显示 _MENU_ 条结果",sZeroRecords:"没有匹配结果",sInfo:"显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",sInfoEmpty:"显示第 0 至 0 条结果，共 0 条",sInfoFiltered:"(由 _MAX_ 条结果过滤)",sInfoPostFix:"",sSearch:"搜索:",sUrl:"",sEmptyTable:"表中数据为空",sLoadingRecords:"载入中...",sInfoThousands:",",oPaginate:{sFirst:"首页",sPrevious:"上页",sNext:"下页",sLast:"末页"},oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},paging:e.paging,pageLength:e.pageLength||10,columnDefs:e.columnDefs||"",order:e.order||[],createdRow:e.createdRow||null};e.scrollX&&(t.scrollX=e.scrollX);var a=$("#"+e.id).DataTable(t);return a}function d(e,t,a,d){$("#"+e+" tbody").off(t,a).on(t,a,d)}function r(e){var t=$("#"+e).DataTable().row($(this).parents("tr")).data();return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a,t.bindTableEvent=d,t.getTableItem=r},509:function(e,t,a){"use strict";function d(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),l=d(r),i=a(24),n=d(i),s=a(6),o=d(s),c=a(3),u=d(c),p=a(4),f=d(p),m=a(8),v=d(m),h=a(7),b=d(h),g=a(2),y=(d(g),a(12)),N=d(y),x=a(21),T=d(x),_=a(10),w=a(197),k=a(144),z="",q={},C="",R="",H='<select name="type" class="form-control"><option value="string">string</option><option value="long">long</option><option value="double">double</option><option value="date">date</option><option value="geo_point">geo_point</option><option value="nested">nested</option></select>',O='<select name="store" class="form-control"><option value="true">是</option><option value="false" selected>否</option></select>',D='<select name="index" class="form-control"><option value="true" selected>是</option><option value="false">否</option></select>',I='<select class="form-control" name="key"><option value="true">是</option><option value="false" selected>否</option></select>',S=(0,l.default)("option",{value:""},void 0,"请选择"),P=(0,l.default)("div",{className:"box-header with-border "},void 0,(0,l.default)("p",{className:"box-title"},void 0,"基本信息")),E=(0,l.default)("label",{htmlFor:"datasetName"},void 0,(0,l.default)("span",{className:"identify"},void 0,"* "),"名称 : "),U=(0,l.default)("div",{name:"isPartition",className:"form-group col-md-3"},void 0,(0,l.default)("label",{htmlFor:"isPartition"},void 0,(0,l.default)("span",{className:"identify"},void 0,"* "),"是否分区 : "),(0,l.default)("div",{className:"radio"},void 0,(0,l.default)("label",{},void 0,(0,l.default)("input",{name:"isPartition",type:"radio",value:"true"})," 是"),(0,l.default)("label",{className:"ml20"},void 0,(0,l.default)("input",{name:"isPartition",type:"radio",value:"false"})," 否"))),F=(0,l.default)("div",{name:"isVisible",className:"form-group col-md-3"},void 0,(0,l.default)("label",{htmlFor:"isVisible"},void 0,(0,l.default)("span",{className:"identify"},void 0,"* "),"可见性 : "),(0,l.default)("div",{className:"radio"},void 0,(0,l.default)("label",{},void 0,(0,l.default)("input",{name:"isVisible",type:"radio",value:"PUBLIC"})," 共享"),(0,l.default)("label",{className:"ml20"},void 0,(0,l.default)("input",{name:"isVisible",type:"radio",value:"PRIVATE"})," 私有"))),V=(0,l.default)("label",{},void 0,(0,l.default)("span",{className:"identify"},void 0,"* "),"分片数 : "),A=(0,l.default)("label",{},void 0,(0,l.default)("span",{className:"identify"},void 0,"* "),"副本数 : "),M=(0,l.default)("span",{className:"messages"}),J=(0,l.default)("div",{className:"box-header with-border "},void 0,(0,l.default)("p",{className:"box-title"},void 0,"字段")),L=(0,l.default)("thead",{},void 0,(0,l.default)("tr",{},void 0,(0,l.default)("th",{}),(0,l.default)("th",{},void 0,"字段名"),(0,l.default)("th",{},void 0,"字段描述"),(0,l.default)("th",{},void 0,"字段类型"),(0,l.default)("th",{},void 0,"存储"),(0,l.default)("th",{},void 0,"索引"),(0,l.default)("th",{},void 0,"分词"),(0,l.default)("th",{},void 0,"主键"),(0,l.default)("th",{},void 0,"操作"))),X=(0,l.default)("div",{className:"box-header with-border"},void 0,(0,l.default)("p",{className:"box-title"},void 0,"分区信息")),j=(0,l.default)("label",{htmlFor:"partitionField"},void 0,"分区字段："),B=(0,l.default)("label",{htmlFor:"partitionRule"},void 0,"分区规则："),Z=(0,l.default)("i",{className:"fa fa-save"}),G=function(e){function t(e){(0,u.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return a.createDataSetHandler=a.createDataSetHandler.bind(a),a.selectIndexHandler=a.selectIndexHandler.bind(a),a.selectTypeHandler=a.selectTypeHandler.bind(a),a.fieldDetailHandler=a.fieldDetailHandler.bind(a),a.createNestedFieldHandler=a.createNestedFieldHandler.bind(a),a.replicationJudge=a.replicationJudge.bind(a),a.fieldInputHandler=a.fieldInputHandler.bind(a),a}return(0,b.default)(t,e),(0,f.default)(t,[{key:"componentWillMount",value:function(){this.props.getDataset(this.props.params.datasetName),this.props.getMaxSettingNums(),this.props.listAnalyzers()}},{key:"componentDidUpdate",value:function(){this.crateTableHandler(),z=this.props.dataset.selectedRecord.schema.properties;for(var e="",t=0;t<this.props.dataset.analyzers.length;t++)e+='<option value="'+this.props.dataset.analyzers[t]+'">'+this.props.dataset.analyzers[t]+"</option>";R='<select name="analyzer" class="form-control" id="analyzer">'+e+"</select>"}},{key:"componentDidMount",value:function(){0==this.props.dataset.selectedRecord.isPartition&&$('div[name = "partitionArea"]').hide(),1==this.props.dataset.selectedRecord.isPartition?$('input[name="isPartition"][value="true"]',$("#datasetUpdate")).attr("checked",!0):$('input[name="isPartition"][value="false"]',$("#datasetUpdate")).attr("checked",!0),"PRIVATE"==this.props.dataset.selectedRecord.visable?$('input[name="isVisible"][value="PRIVATE"]',$("#datasetUpdate")).attr("checked",!0):$('input[name="isVisible"][value="PUBLIC"]',$("#datasetUpdate")).attr("checked",!0),$('input[name="isVisible"]:checked',$("#datasetUpdate")).attr("checked",!0),$('input[name = "isPartition"]',$("#datasetUpdate")).attr("disabled","disabled"),(0,N.default)('input[ type = "radio"]')}},{key:"crateTableHandler",value:function(){var e={};e.id="schema",e.columns=[{className:"textCenter",orderable:!1,data:null,defaultContent:""},{data:"fieldName",render:function(e,t,a){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"name",render:function(e,t,a){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"type",orderable:!1},{data:"store",render:function(e,t,a,d){return"nested"==a.type?"-":"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:O},{data:"index",render:function(e,t,a,d){return"nested"==a.type?"-":"not_analyzed"==e||"analyzed"==e?"是":"no"==e?"否":void 0},orderable:!1,defaultContent:D},{data:"analyzer",orderable:!1,defaultContent:"-"},{data:"key",render:function(e,t,a){return"nested"==a.type?"-":"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:I},{className:"",orderable:!1,data:"operation",defaultContent:"-"}],e.dom='<"top">rt<"bottom"i>',e.scrollX=!1,e.paging=!1,e.createdRow=function(e,t,a){var d="<span class='row-details row-details-close mt10 hide'></span><i class='fa fa-circle-thin mt10'></i>";"nested"===t.type&&(d="<span class='row-details row-details-close mt10'></span>"),t.fieldName.indexOf("<input")==-1&&$("td:eq(1)",e).attr("title",t.fieldName),t.name.indexOf("<input")==-1&&$("td:eq(2)",e).attr("title",t.name),$("td:eq(0)",e).html(d)},e.data=this.props.dataset.selectedRecord.schema.properties;var t=(0,T.default)(e);$("#schema").on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),a=t.row(e);a.remove(),t.draw()}),$("#schema").on("click","tbody td .row-details",this.fieldDetailHandler)}},{key:"fieldDetailHandler",value:function(e){var t=$("#schema").DataTable(),a=$(e.currentTarget).parents("tr"),d=t.row(a);if(d.child.isShown()){for(var r=0;r<$("input.fieldName").length;r++){if(""==$("input.fieldName").eq(r).val().trim())return $("input.fieldName").eq(r).css("border","1px #dd4b39 solid"),void(0,_.error)("请输入字段名 （同级字段名不能重复） !");if($("input.fieldName").eq(r).css("border","1px #d2d6de solid"),$("input.fieldName").eq(r).val().length>30)return $("input.fieldName").eq(r).css("border","1px #dd4b39 solid"),void(0,_.error)("字段名最长为30个字符 !");if($("input.fieldName").eq(r).css("border","1px #d2d6de solid"),!/^(?!_)(?!.*?_$)/.test($("input.fieldName").eq(r).val()))return $("input.fieldName").eq(r).css("border","1px #dd4b39 solid"),void(0,_.error)("请检查字段名填写，下划线不能放在首尾 !");if($("input.fieldName").eq(r).css("border","1px #d2d6de solid"),!/^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$/.test($("input.fieldName").eq(r).val()))return $("input.fieldName").eq(r).css("border","1px #dd4b39 solid"),void(0,_.error)("请检查字段名填写，只能含有英文字母、数字和下划线 !");$("input.fieldName").eq(r).css("border","1px #d2d6de solid")}$(e.currentTarget).addClass("row-details-close").removeClass("row-details-open");for(var l=d.child().find("tbody tr"),i=[],s=0;s<$(l).length;s++){var o=$(l)[s];if(0!=$("input.fieldName",$(o)).length){var c={},u=$('select[name = "type"]',$(o)).val(),p=$('select[name = "index"]',$(o)).val(),f=$('select[name = "analyzer"]',$(o)).val();c.fieldName=$("input.fieldName",$(o)).val(),c.name=$("input.name",$(o)).val(),c.type=u,c.store=$('select[name = "store"]',$(o)).val(),0!=$("input.fieldName",$(o)).length&&("false"==p?c.index="no":"string"!=u?c.index="not_analyzed":"string"==u&&"not_analyzed"==f?c.index="not_analyzed":"string"==u&&"not_analyzed"!=f&&(c.index="analyzed",c.analyzer=f)),c.key=$('select[name = "key"]',$(o)).val(),i.push(c)}}a.attr("schema",(0,n.default)(i)),d.child.hide()}else{if($(e.currentTarget).addClass("row-details-open").removeClass("row-details-close"),d.child())return void d.child.show();this.createNestedFieldHandler(d)}}},{key:"createNestedFieldHandler",value:function(e){e.child('<div id="nestRow_'+e.index()+'"><button type="submit" name="createNested" class="btn btn-sm btn-default mb5">\n                                <i class="fa fa-fw fa-plus-circle"></i>\n                                添加子字段\n                           </button>\n                           <table id="nestTable_'+e.index()+'"  class="table table-bordered" width="100%">\n                           <thead>\n                               <tr>\n                                   <th>子字段名</th>\n                                   <th>子字段描述</th>\n                                   <th>子字段类型</th>\n                                   <th>存储</th>\n                                   <th>索引</th>\n                                   <th>分词</th>\n                                   <th>主键</th>\n                                   <th>操作</th>\n                               </tr>\n                           </thead>\n                        </table></div>').show();var t={};t.id="nestTable_"+e.index(),t.columns=[{data:"fieldName",render:function(e,t){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"name",render:function(e,t){return e?e.indexOf("<input")!=-1?e:(0,w.cutStr)(e,15):e},orderable:!1},{data:"type",orderable:!1},{data:"store",render:function(e,t,a,d){return"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:O},{data:"index",render:function(e,t,a,d){return"not_analyzed"==e||"analyzed"==e?"是":"no"==e?"否":void 0},orderable:!1,defaultContent:D},{data:"analyzer",orderable:!1,defaultContent:"-"},{data:"key",render:function(e,t,a,d){return"false"==e?"否":"true"==e?"是":void 0},orderable:!1,defaultContent:I},{className:"",orderable:!1,data:"operation",defaultContent:"-"}],t.paging=!1,t.dom='<"top">rt<"bottom"i>',t.scrollX=!1,t.createdRow=function(e,t,a){t.fieldName.indexOf("<input")==-1&&$("td:eq(0)",e).attr("title",t.fieldName),t.name.indexOf("<input")==-1&&$("td:eq(1)",e).attr("title",t.name)},t.data=e.data().schema;var a=(0,T.default)(t);$("#nestTable_"+e.index()).on("click","tbody td .fa-trash-o",function(){var e=$(this).parents("tr"),t=a.row(e);t.remove(),a.draw()}),$('button[name = "createNested"]',$("#nestRow_"+e.index())).off("click").on("click",function(){var t=$("#nestTable_"+e.index()).DataTable();t.row.add({data:"",fieldName:'<input type="text" placeholder="支持英文、数字、下划线" maxlength= "30" class="fieldName form-control">',name:'<input type="text" class="name form-control">',type:'<select name="type" class="form-control" id="a"><option value="string">string</option><option value="long">long</option><option value="double">double</option><option value="date">date</option><option value="geo_point">geo_point</option></select>',store:'<select name="store" class="form-control"  id="store"><option value="true">是</option><option value="false" selected>否</option></select>',index:'<select name="index" class="form-control"  id="index"><option value="true">是</option><option value="false">否</option></select>',analyzer:R,key:'<select class="form-control"  name="key" id="key"><option value="true">是</option><option value="false" selected>否</option></select>',operation:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}).draw(),$('select[name = "type"]',$("#nestTable_"+e.index())).change(function(){"string"===$(this).val()&&"true"==$(this).closest("tr").find('select[name = "index"]').val()?$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}),$("input.fieldName",$("#nestTable_"+e.index())).blur(function(t){for(var a=$(t.currentTarget).val().trim(),d=[],r=[],l=0;l<z.length;l++)"nested"==z[l].type&&r.push(z[l]);for(var i=0;i<r.length;i++)if(i+1==e.index())for(var n=0;n<z[e.index()].schema.length;n++)d.push(z[e.index()].schema[n].fieldName);return $("input.fieldName",$("#nestTable_"+e.index())).not($(t.currentTarget)).each(function(e,t){""!=$(t).val().trim()&&d.push($(t).val())}),d.indexOf(a)!=-1?($(t.currentTarget).css("border","1px #dd4b39 solid"),$(t.currentTarget).val(""),void $(t.currentTarget).focus()):($(t.currentTarget).css("border","1px #d2d6de solid"),$(t.currentTarget).val().length>=30?void $(t.currentTarget).css("border","1px #dd4b39 solid"):($(t.currentTarget).css("border","1px #d2d6de solid"),/^(?!_)(?!.*?_$)/.test($(t.currentTarget).val())?($(t.currentTarget).css("border","1px #d2d6de solid"),/^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$/.test($(t.currentTarget).val())?void $(t.currentTarget).css("border","1px #d2d6de solid"):void $(t.currentTarget).css("border","1px #dd4b39 solid")):void $(t.currentTarget).css("border","1px #dd4b39 solid")))}),$('select[name = "index"]',$("#nestTable_"+e.index())).change(function(){"true"===$(this).val()&&"string"==$(this).closest("tr").find('select[name = "type"]').val()?$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(this).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)})})}},{key:"deleteEmptyObj",value:function(e){var t=[];for(var a in e)for(var d in e[a]){if(""==d||""==e[a][d])return;t.push(e[a]);break}return t}},{key:"createDataSetHandler",value:function(){if(this.validateHandler(),$("span.messages").find("p").length>0)return void(0,_.error)("副本数输入异常，请检查后重新提交！");for(var e=0;e<$("input.fieldName").length;e++){if(""==$("input.fieldName").eq(e).val())return $("input.fieldName").eq(e).css("border","1px #dd4b39 solid"),void(0,_.error)("请输入字段名 （同级字段名不能重复） !");if($("input.fieldName").eq(e).css("border","1px #d2d6de solid"),$("input.fieldName").eq(e).val().length>30)return $("input.fieldName").eq(e).css("border","1px #dd4b39 solid"),void(0,_.error)("字段名最长为30个字符 !");if($("input.fieldName").eq(e).css("border","1px #d2d6de solid"),!/^(?!_)(?!.*?_$)/.test($("input.fieldName").eq(e).val()))return $("input.fieldName").eq(e).css("border","1px #dd4b39 solid"),void(0,_.error)("请检查字段名填写，下划线不能放在首尾 !");if($("input.fieldName").eq(e).css("border","1px #d2d6de solid"),!/^(?!_)(?!.*?_$)[a-zA-Z0-9_]+$/.test($("input.fieldName").eq(e).val()))return $("input.fieldName").eq(e).css("border","1px #dd4b39 solid"),void(0,_.error)("请检查字段名填写，只能含有英文字母、数字和下划线 !");$("input.fieldName").eq(e).css("border","1px #d2d6de solid")}var t={};t.datasetName=$("#datasetName",$("#datasetUpdate")).val(),t.isPartition=$('input[name = "isPartition"]:checked',$("#datasetUpdate")).val(),t.visable=$('input[name = "isVisible"]:checked',$("#datasetUpdate")).val(),t.replication=$("#replication",$("#datasetUpdate")).val(),t.shard=$("#shard",$("#datasetUpdate")).val(),t.schema={},t.owner=sessionStorage.getItem("XDataUserName"),t.schema.properties=[],$("span.row-details-open",$("#schema")).click();for(var a=this.props.dataset.selectedRecord.schema.properties,d=[],r=0;r<a.length;r++)if("nested"==a[r].type){var l=$("tbody tr",$("#schema"))[r],i=a[r].schema.concat($(l).attr("schema")?JSON.parse($(l).attr("schema")):[]);a[r].schema=this.deleteEmptyObj(i),d.push(a[r])}for(var n=a.length;n<$("tbody tr",$("#schema")).length;n++){var s=$("tbody tr",$("#schema"))[n],o=$('select[name = "index"]',$(s)).val(),c=$('select[name = "type"]',$(s)).val(),u=$('select[name = "analyzer"]',$(s)).val();if(0!=$("input.fieldName",$(s)).length){var p={};p.fieldName=$("input.fieldName",$(s)).val(),p.name=$("input.name",$(s)).val(),p.type=c,"nested"===c?p.schema=$(s).attr("schema")?JSON.parse($(s).attr("schema")):[]:(p.store=$('select[name = "store"]',$(s)).val(),p.key=$('select[name = "key"]',$(s)).val(),0!=$("input.fieldName",$(s)).length&&("false"==o?p.index="no":"string"!=c?p.index="not_analyzed":"string"==c&&"not_analyzed"==u?p.index="not_analyzed":"string"==c&&"not_analyzed"!=u&&(p.index="analyzed",p.analyzer=u))),t.schema.properties.push(p)}}0!=d.length&&(t.schema.properties=t.schema.properties.concat(d)),this.props.modifyDataset(t),this.props.history.replace("/dataSet")}},{key:"handleCreateHandler",value:function(){var e=$("#schema").DataTable();e.row.add({data:"",fieldName:'<input type="text" placeholder="支持英文、数字、下划线" maxlength= "30" class="fieldName fieldNamer form-control">',name:'<input type="text" class="name form-control">',type:H,store:O,index:"",analyzer:R,key:"",operation:'<i class="fa fa-trash-o" style="cursor: pointer;" title="删除"></i>'}).draw(),$('select[name = "type"]',$("#schema")).change(this.selectTypeHandler),$("input.fieldName",$("#schema")).blur(this.fieldInputHandler),$('select[name = "index"]',$("#schema")).change(this.selectIndexHandler)}},{key:"fieldInputHandler",value:function(e){for(var t=this.props.dataset.selectedRecord.schema.properties,a=$(e.currentTarget).val().trim(),d=[],r=0;r<t.length;r++)d.push(t[r].fieldName);return $("input.fieldNamer").not($(e.currentTarget)).each(function(e,t){""!=$(t).val().trim()&&d.push($(t).val())}),d.indexOf(a)!=-1?($(e.currentTarget).css("border","1px #dd4b39 solid"),$(e.currentTarget).val(""),void $(e.currentTarget).focus()):($(e.currentTarget).css("border","1px #d2d6de solid"),""==a?void $(e.currentTarget).css("border","1px #dd4b39 solid"):void $(e.currentTarget).css("border","1px #d2d6de solid"))}},{key:"selectIndexHandler",value:function(e){var t=$(e.currentTarget).val();"true"===t&&"string"==$(e.currentTarget).closest("tr").find('select[name = "type"]').val()?$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}},{key:"validateHandler",value:function(){var e={replication:{presence:{message:"请输入副本数"},numericality:{onlyInteger:!0,notInteger:"请输入整数",notValid:"请输入数字",greaterThanOrEqualTo:0,lessThanOrEqualTo:this.props.dataset.maxSettingNums.maxReplicationNum,notGreaterThanOrEqualTo:"最小值为 0",notLessThanOrEqualTo:"最大值为 "+this.props.dataset.maxSettingNums.maxReplicationNum}}};(0,k.baseValidate)($(".replicationJudgeDiv"),e)}},{key:"replicationJudge",value:function(e){var t={replication:{presence:{message:"请输入副本数"},numericality:{onlyInteger:!0,notInteger:"请输入整数",notValid:"请输入数字",greaterThanOrEqualTo:0,lessThanOrEqualTo:parseInt(e.target.max,10),notGreaterThanOrEqualTo:"最小值为 0",notLessThanOrEqualTo:"最大值应小于等于 "+e.target.max}}};(0,k.baseValidate)($(".replicationJudgeDiv"),t)}},{key:"selectTypeHandler",value:function(e){var t=$(e.currentTarget).val(),a=$(e.currentTarget).closest("tr").find("input.fieldName").val();if("nested"===t)$(e.currentTarget).closest("tr").find("span.row-details-close").click(),$("span.row-details",$(e.currentTarget).closest("tr")).removeClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).addClass("hide"),$(e.currentTarget).closest("tr").find('select[name = "store"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "index"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "key"]').prop("disabled",!0),$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0),delete q[a];else{var d=$("#schema").DataTable(),r=$(e.currentTarget).parents("tr"),l=d.row(r);l.child.isShown()&&($(e.currentTarget).closest("tr").find("span.row-details-open").addClass("row-details-close").removeClass("row-details-open"),l.child.hide()),$("span.row-details",$(e.currentTarget).closest("tr")).addClass("hide"),$("i.fa-circle-thin",$(e.currentTarget).closest("tr")).removeClass("hide"),$(e.currentTarget).closest("tr").find('select[name = "store"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "index"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "key"]').prop("disabled",!1),$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1),"date"===t?q[a]=a:delete q[a],"string"===t&&"true"==$(e.currentTarget).closest("tr").find('select[name = "index"]').val()?$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!1):$(e.currentTarget).closest("tr").find('select[name = "analyzer"]').prop("disabled",!0)}}},{key:"render",value:function(){var e=[S];for(var t in this.props.dataset.dateFields)e.push((0,l.default)("option",{value:t},void 0,this.props.dataset.dateFields[t]));return this.props.dataset.selectedRecord.partitionRule&&(C=this.props.dataset.selectedRecord.partitionRule),C.indexOf("d")!=-1?C=C.substring(0,C.length-1)+" 天":C.indexOf("w")!=-1?C=C.substring(0,C.length-1)+" 周":C.indexOf("M")!=-1?C=C.substring(0,C.length-1)+" 月":C.indexOf("y")!=-1&&(C=C.substring(0,C.length-1)+" 年"),(0,l.default)("div",{id:"datasetUpdate"},void 0,(0,l.default)("div",{className:"box box-primary"},void 0,P,(0,l.default)("div",{className:"box-body"},void 0,(0,l.default)("div",{className:"row"},void 0,(0,l.default)("div",{className:"col-md-6 form-group"},void 0,E,(0,l.default)("input",{type:"text",id:"datasetName",className:"form-control",disabled:!0,value:this.props.dataset.selectedRecord.datasetName})),U,F),(0,l.default)("div",{className:"row"},void 0,(0,l.default)("div",{className:"col-md-6 form-group"},void 0,V,(0,l.default)("input",{type:"number",id:"shard",className:"form-control",disabled:!0,value:this.props.dataset.selectedRecord.shard})),(0,l.default)("div",{className:"replicationJudgeDiv col-md-6 form-group"},void 0,A,M,(0,l.default)("input",{type:"text",name:"replication",id:"replication",onBlur:this.replicationJudge,min:"0",max:this.props.dataset.maxSettingNums.maxReplicationNum,defaultValue:this.props.dataset.selectedRecord.replication,className:"form-control",placeholder:"0 <= 副本数 <= "+this.props.dataset.maxSettingNums.maxReplicationNum}))))),(0,l.default)("div",{className:"box box-primary"},void 0,J,(0,l.default)("div",{className:"row box-body"},void 0,(0,l.default)("div",{className:"col-md-12"},void 0,(0,l.default)("div",{className:"box-header pull-left"},void 0,(0,l.default)("button",{type:"submit",name:"createDataset",className:"btn btn-primary",onClick:this.handleCreateHandler.bind(this)},void 0,(0,l.default)("i",{className:"fa fa-fw fa-plus-circle",style:{verticalAlign:"middle",padding:"0 8px 0 0"}}),"添加字段")),(0,l.default)("div",{className:"box-body"},void 0,(0,l.default)("table",{id:"schema",className:"table table-striped table-bordered",style:{width:"100%"}},void 0,L))))),(0,l.default)("div",{name:"partitionArea",className:"box box-primary"},void 0,X,(0,l.default)("div",{className:"partition box-body"},void 0,(0,l.default)("div",{className:"partitionDetails row"},void 0,(0,l.default)("div",{className:"form-group col-md-6"},void 0,j,(0,l.default)("span",{className:"detailSpan ml10"},void 0," ",this.props.dataset.selectedRecord.partitionField," ")),(0,l.default)("div",{className:"form-group col-md-6"},void 0,B,(0,l.default)("span",{className:"detailSpan ml10"},void 0," ",C," "))))),(0,l.default)("button",{name:"saveBtn",className:"btn btn-primary",onClick:this.createDataSetHandler},void 0,Z," 保存 "))}}]),t}(g.Component);t.default=G}});